<!DOCTYPE html>
<html>
    <head>
        <title>Week 7 Presentation</title>
        <link rel="stylesheet" href="index.css" /> 
        <script>
            window.onload = function () {
                window.location = "#0";
            }
        </script>
		<script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.26.0/babel.js"></script> 
    </head>
    <body>
        <div class = "wrapper">
            <div class = "intro slide">
                <div>Presentation: Week 7</div>
                <div>Erol Cimen</div>
            </div>
        </div>
        <div class = "wrapper">
            <div class = "slide">
                <div class = "slide-header">Test</div>
                <div class = "main-content">It would be cool if you had an interactive pathway for TOAST classification + worked example</div>
            </div>
        </div>
        <div class = "wrapper">
            <div class = "slide">
                <div class = "slide-header">TOAST Decision Tree</div>
				<div>
					<ul>
						<li>Neuro Exam: Postural Instability</li>
						<li>CT: infarct in PICA territory</li>
						<li>MRI: </li>
						<li>MR-Angiography: left vertebral artery dissection</li>
					</ul>
				</div>
				<div id = "TOASTtarget"></div> 
            </div>
        </div>
        <div class = "wrapper">
            <div class = "slide">
                <div class = "slide-header">Test</div>
            </div>
        </div>
        <div class = "wrapper">
            <div class = "slide">
                <div class = "slide-header">Test</div>
            </div>
        </div>
    </body>
    <script>
        let slides = Array.from(document.getElementsByClassName("wrapper"));
        slides.forEach((elem, index) => {
            elem.id = index;
        });
        console.log(slides.length);

        let startingPos = 0;
        let manageState = (changePos) => {
            if ( (startingPos + changePos) < slides.length && (startingPos + changePos) >= 0) {
                startingPos += changePos;
            }
            window.location = "#" + startingPos;
            console.log(startingPos);
        }
        document.addEventListener("keydown", function(event){
            switch(event.key) {
                case 'n':
                case 'N':
                case 'ArrowRight':
                    manageState(1)
                    return
                case 'b':
                case 'B':
                case 'ArrowLeft':
                    manageState(-1);
                    return
                default:
                    return
            }
        });
		
		let LAA = 'Large Artery Atherosclerosis'
		let CE = 'Cardiac Source of Embolism' 
		let LAC = 'Small-Vessel Occlusion (Lacune)'
		let SOD = 'Stroke of Other Determined Aetiology'
		let UT = 'Undetermined Aetiology (Cryptogenic)'	
		
		let testArr = [{
			question: 'Was angiography performed?',
			answerYes: 1,
			answerNo: 8
		}, 
		{
			question: 'Was stenosis >50% of a large extracranial artery supplying the area of ischaemia found?',
			answerYes: 2,
			answerNo: 4
		},
		{
			question: 'Are there any potential cardioembolic sources?',
			answerYes: 'Undetermined - two or more potential causes',
			answerNo: 3
		},
		{
			question: 'Does the patient have a classical lacunar syndrome, with or without a small (<1.5cm) subcortical lacunar infarct pattern?',
			answerYes: 'Undetermined - two or more potential causes',
			answerNo: 'Large Artery Atherosclerosis'
		},
		{
			question: 'Are there any potential cardioembolic sources?',
			answerYes: 5,
			answerNo: 6
		},
		{
			question: 'Does the patient have a classical lacunar syndrome, with or without a small (<1.5cm) subcortical lacunar infarct pattern?',
			answerYes: 'Undetermined - two or more potential causes (Cardioembolic and Lacunar)',
			answerNo: 'Cardioembolism'
		},
		{
			question: 'Does the patient have any rare causes of stroke?',
			answerYes: 'Stroke of Other Determined Aetiology',
			answerNo: 7,
		}, 
		{
			question: 'Does the patient have a classical lacunar syndrome, with or without a small (<1.5cm) subcortical lacunar infarct pattern?',
			answerYes: 'Small-vessel Disease (Lacune)',
			answerNo: 'Undetermined Aetiology owing to a Negative Evaluation'
		},
		{
			question: 'Are there any high-risk cardioembolic sources?',
			answerYes: 'Cardioembolism',
			answerNo: 'Undetermined due to incomplete investigation'
		}]
    </script>
	<script type="text/babel">		
		class Tree extends React.Component {
			constructor(props) {
				super(props);
				this.state = {
					test: 0,
					leaf: false,
				}
				this.yesClick = this.yesClick.bind(this);
				this.noClick = this.noClick.bind(this);
				this.resetEverything = this.resetEverything.bind(this);
			}

			yesClick () {
				if (typeof testArr[this.state.test].answerYes === "number") {
						this.setState(function (state, props) {
						return {test: testArr[state.test].answerYes}
					})
				} else {
					this.setState(function (state, props) {
						return {leaf: true, answer: testArr[state.test].answerYes}
					})
				}
			}

			noClick () {
				if (typeof testArr[this.state.test].answerNo === "number") {
						this.setState(function (state, props) {
						return {test: testArr[state.test].answerNo}
					})
				} else {
					this.setState(function (state, props) {
						return {leaf: true, answer: testArr[state.test].answerYes}
					})
				}		
			}

			resetEverything () {
				this.setState({
					test: 0,
					leaf: false,
				})
			}

			render () {
				if (!this.state.leaf) {
					return (
					<div id = "container">
						<div className = "questions">{testArr[this.state.test].question}</div>
						<div className = "buttonContainer">
							<button onClick = {this.yesClick} id = "testYes">Yes</button>
							<button onClick = {this.noClick} id = "testNo">No</button>
						</div> 
					</div>
					);		
				} else {
					return (
					<div id = "container">
						<div>TOAST category:</div>
						<div className = "answer">{this.state.answer}</div>
						<button onClick = {this.resetEverything}>Try Again</button> 
					</div>
					);	
				}
			}
		}
		
		ReactDOM.render(<Tree />, document.getElementById("TOASTtarget"));
	</script> 
</html>